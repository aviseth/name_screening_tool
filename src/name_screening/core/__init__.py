"""Core matching and extraction functionality."""